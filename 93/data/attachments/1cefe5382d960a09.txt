const jsonData = pm.response.json();

pm.test("Validate response status", function () {
    pm.response.to.have.status(200);
});

const response = pm.response.json();

// Validate the structure of the response
pm.test("Validate response structure", function () {
    pm.expect(response).to.have.property('status').that.equals('success');
    pm.expect(response).to.have.property('message').that.equals('success');
    pm.expect(response).to.have.property('data').that.is.an('object');
    pm.expect(response.data).to.have.property('data').that.is.an('array');
    pm.expect(response.data).to.have.property('meta').that.is.an('object');

    
    response.data.data.forEach(promotion => {
        pm.expect(promotion).to.have.all.keys(
            'id', 'created_on', 'created_by', 'modified_on', 
            'modified_by', 'title', 'description', 'type', 
            'active', 'number_of_subscribers', 'product_id', 
            'image', 'mobile_image', 'action_url', 'extra_data', 
            'product'
        );

        pm.expect(promotion.product).to.have.all.keys(
            'id', 'created_on', 'created_by', 'modified_on', 
            'modified_by', 'deleted_by', 'deleted_flag', 
            'name', 'description', 'icon_url', 'status', 
            'amount', 'meta', 'product_group_id', 'category_id'
        );
    });

});

